<div class="container my-5">
    <h1 class="mb-4">ユーザー検索結果</h1>
  
    <% if @users.any? %>
      <div class="table-responsive">
        <table class="table table-bordered">
          <thead class="thead-light">
            <tr>
              <th>ユーザー名</th>
              <th>最新投稿1</th>
              <th>最新投稿2</th>
            </tr>
          </thead>
          <tbody>
            <% @users.each do |user| %>
              <tr>
                <td class="align-middle">
                  <%= link_to "#{user.last_name} #{user.first_name}", public_user_path(user) %>
                </td>
  
                <% latest_posts = user.posts.order(created_at: :desc).limit(2) %>
                <% if latest_posts.any? %>
                  <% latest_posts.each do |post| %>
                    <td class="text-center align-top">
                      <% if post.images.attached? %>
                        <%= link_to public_post_path(post) do %>
                          <%= image_tag post.images.first.variant(resize_to_limit: [300, 300]),
                                        class: "img-fluid img-thumbnail mb-2" %>
                        <% end %>
                      <% else %>
                        <%= link_to public_post_path(post) do %>
                          <%= image_tag "no_image_logo.png", size: "300x300", class: "img-fluid img-thumbnail mb-2" %>
                        <% end %>
                      <% end %>
                      <div>
                        <%= link_to post.title, public_post_path(post), class: "d-block text-truncate" %>
                        <small class="text-muted d-block"><%= l post.created_at, format: :short %></small>
                      </div>
                    </td>
                  <% end %>
  
                  <%# 投稿が1件しかない場合は空セル追加 %>
                  <% (2 - latest_posts.size).times do %>
                    <td></td>
                  <% end %>
                <% else %>
                  <td colspan="2" class="text-muted text-center align-middle">投稿はまだありません</td>
                <% end %>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    <% else %>
      <p>ユーザーが見つかりませんでした。</p>
    <% end %>
</div>